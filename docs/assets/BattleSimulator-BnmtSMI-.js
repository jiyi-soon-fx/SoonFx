class g{constructor(e,t,a){this.round=0,this.maxRounds=100,this.hero=e,this.enemy=t,this.logger=a}calculateDamage(e,t){let a=e.attack-t.defense;const o=.8+Math.random()*.4;return a=Math.floor(a*o),Math.max(1,a)}executeAttack(e,t){const a=this.calculateDamage(e,t),o=t.takeDamage(a);return this.logger.addLog(`  ${e.name} æ”»å‡» ${t.name}ï¼Œé€ æˆ ${o} ç‚¹ä¼¤å®³ï¼ï¼ˆ${t.name} å‰©ä½™è¡€é‡: ${t.currentHp}/${t.maxHp}ï¼‰`),o}battleRound(){this.round++,this.logger.addLog(`
----- ç¬¬ ${this.round} å›åˆ -----`),this.logger.addLog(`${this.hero.getStatus()}`),this.logger.addLog(`${this.enemy.getStatus()}`);const e={heroHp:this.hero.currentHp,heroHpPercent:this.hero.getHpPercentage(),enemyHp:this.enemy.currentHp,enemyHpPercent:this.enemy.getHpPercentage()},t=this.executeAttack(this.hero,this.enemy),a=()=>{e.enemyHp=this.enemy.currentHp,e.enemyHpPercent=this.enemy.getHpPercentage(),e.heroHp=this.hero.currentHp,e.heroHpPercent=this.hero.getHpPercentage()};if(!this.enemy.isAlive())return a(),this.logger.addLog(`
ğŸ‰ ${this.enemy.name} è¢«å‡»è´¥äº†ï¼`),this.logger.addRoundData(this.round,{...e,heroDamageDealt:t,enemyDamageDealt:0,winner:this.hero.name,battleEnd:!0}),!0;const o=this.executeAttack(this.enemy,this.hero);return this.hero.isAlive()?(a(),this.logger.addRoundData(this.round,{...e,heroDamageDealt:t,enemyDamageDealt:o,battleEnd:!1}),!1):(this.logger.addLog(`
ğŸ’€ ${this.hero.name} è¢«å‡»è´¥äº†ï¼`),a(),this.logger.addRoundData(this.round,{...e,heroDamageDealt:t,enemyDamageDealt:o,winner:this.enemy.name,battleEnd:!0}),!0)}startBattle(){for(this.logger.addLog(`
========================================`),this.logger.addLog("âš”ï¸  æˆ˜æ–—å¼€å§‹ï¼"),this.logger.addLog("========================================"),this.logger.addLog(`${this.hero.getStatus()}`),this.logger.addLog("VS"),this.logger.addLog(`${this.enemy.getStatus()}`),this.logger.addLog(`========================================
`);this.round<this.maxRounds&&!this.battleRound(););this.round>=this.maxRounds&&this.logger.addLog(`
â±ï¸  æˆ˜æ–—è¶…æ—¶ï¼Œå¹³å±€ï¼`);const e=this.hero.isAlive()?this.hero.name:this.enemy.isAlive()?this.enemy.name:"å¹³å±€";return this.logger.addLog(`
========================================`),this.logger.addLog("ğŸ“Š æˆ˜æ–—ç»“æŸç»Ÿè®¡"),this.logger.addLog("========================================"),this.logger.addLog(`èƒœåˆ©è€…: ${e}`),this.logger.addLog(`æ€»å›åˆæ•°: ${this.round}`),this.logger.addLog(`${this.hero.name} æœ€ç»ˆçŠ¶æ€: ${this.hero.getStatus()}`),this.logger.addLog(`${this.enemy.name} æœ€ç»ˆçŠ¶æ€: ${this.enemy.getStatus()}`),this.logger.addLog(`========================================
`),{winner:e,rounds:this.round,battleData:this.logger.getBattleData()}}}export{g as BattleSimulator};
